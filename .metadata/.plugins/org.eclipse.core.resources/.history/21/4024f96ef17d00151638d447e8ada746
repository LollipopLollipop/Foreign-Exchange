import com.datastax.driver.core.Cluster;
import com.datastax.driver.core.ResultSet;
import com.datastax.driver.core.Row;
import com.datastax.driver.core.Session;
/**
 * 
 * @author ding
 * Main workflow of HW4: 
 * load prep-ed data from csv to Canssandra
 * randomize 8K training instances and 2K testing instances
 * build the random forest based on training set
 * classify testing set and analyze predicted result
 */

public class HW4 {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		Cluster cluster;
		Session session;
		
		// Connect to the cluster and keyspace "demo"
		cluster = Cluster.builder().addContactPoint("127.0.0.1").build();
		session = cluster.connect("dev");
		
		
		// Insert one record into the users table
		session.execute("insert into emp (empid, emp_first, emp_last, emp_dept) values (2,'jodie','smith','eng')");
		
		// Use select to get the user we just entered
		ResultSet results = session.execute("SELECT * FROM emp");
		for (Row row : results) {
			System.out.format("%s %s\n", row.getString("emp_first"), row.getString("emp_last"));
		}
		
		// Clean up the connection by closing it
		cluster.close();
		
	}

}
